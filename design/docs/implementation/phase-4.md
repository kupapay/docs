# Phase 4 — Enterprise & Integrations

Phase 4 extends Bono Pay into enterprise environments with ERP connectors, fleet management, advanced analytics, and multi-country expansion research. This 6-month phase (March 2027 – August 2027) builds on the mature API, SDKs, and dual-mode signing infrastructure delivered in Phases 1–3.

## Objectives

- **Scope:** ERP connectors, fleet management dashboard, webhook/event streaming enhancements, advanced analytics, and multi-country regulatory research.
- **Target:** Large enterprises, ERP integrators, and government agencies.
- **Duration:** 6 months with quarterly milestones.

## Epics

### 1. ERP connectors

**Description:** Build certified connectors for major ERP systems that enable automatic fiscalization of invoices generated by the ERP.

**Connectors:**

| ERP | Integration method | Priority |
|-----|--------------------|----------|
| **SAP Business One** | SAP DI API / Service Layer add-on | High |
| **Odoo 17+** | Custom module (Python) publishing to Bono Pay REST API | High |
| **Sage X3** | Sage X3 Web Services endpoint | Medium |
| **Custom / in-house** | REST API + SDK (JavaScript / Python) | Ongoing |

**Acceptance criteria:**

- Each connector maps the ERP's invoice data model to Bono Pay's canonical payload.
- Sealed responses (fiscal number, auth code, QR code) are written back to the ERP's invoice record.
- Connectors handle offline queuing: if Bono Pay Cloud is unreachable, invoices are queued locally and retried.
- Error mapping: ERP-side validation errors are translated into meaningful messages.
- Installation guide, configuration reference, and troubleshooting docs for each connector.

**Estimated effort:** 4 weeks per connector.
**Dependencies:** `api/cloud.md`, `api/invoicing-sdk.md`.

### 2. Fleet management dashboard

**Description:** A dedicated dashboard view for enterprises managing many outlets, terminals, and (optionally) DEF devices across multiple locations.

**Features:**

- **Map view:** Geo-located outlets with real-time status (online, offline, syncing).
- **Device health panel:** DEF firmware version, certificate expiry, counter status, free memory (Phase 3 outlets only).
- **Fiscal number audit:** Cross-outlet check for numbering gaps, duplicates, or sequence anomalies.
- **Bulk management:** Batch-create outlets, assign users, push configuration changes.
- **Alert center:** Notifications for offline outlets, failed syncs, approaching certificate expiry, and DGI submission failures.

**Acceptance criteria:**

- Dashboard supports 500+ outlets per merchant without degradation.
- Real-time status updates via WebSocket or SSE (≤ 5 s latency).
- Role-based access: fleet manager role can view all outlets but cannot issue invoices.

**Estimated effort:** 6 weeks.
**Dependencies:** `platform/multi-user.md`, `cloud/architecture.md`.

### 3. Advanced analytics

**Description:** Analytics engine that transforms Fiscal Ledger data into actionable insights for merchants and compliance teams.

**Reports:**

| Report | Description |
|--------|-------------|
| **Revenue trends** | Daily/weekly/monthly revenue by outlet, product category, and tax group |
| **Tax liability forecast** | Projected tax obligations based on current invoicing velocity |
| **Client segmentation** | Invoice volume and revenue by client classification (individual, company, embassy, etc.) |
| **Compliance scorecard** | DGI submission success rate, average sync latency, numbering integrity |
| **Cashier performance** | Invoices per hour, average transaction value, void/refund rate per cashier |

**Acceptance criteria:**

- Analytics queries run against a read replica or data warehouse — no impact on transactional performance.
- Pre-built dashboards for each report with export to CSV, PDF, and Excel.
- API endpoint for programmatic access to analytics data.
- Data retention: analytics data available for at least 10 years (regulatory requirement).

**Estimated effort:** 4 weeks.
**Dependencies:** `fiscal/reports.md`.

### 4. Webhook & event streaming enhancements

**Description:** Upgrade the webhook system to support event streaming for high-throughput integrations and real-time data pipelines.

**Features:**

- **Event streaming:** Optional Kafka/NATS topic per merchant for real-time event consumption.
- **Replay:** Re-deliver events from a specific timestamp or sequence number.
- **Filtering:** Subscribe to specific event types, outlets, or conditions.
- **Dead letter queue:** Automatically quarantine events that fail delivery after max retries.
- **Signature verification:** HMAC-SHA256 signatures on webhook payloads for authenticity.

**Acceptance criteria:**

- Streaming endpoint supports ≥ 1,000 events/second per merchant.
- Replay covers at least 30 days of event history.
- Dead letter queue is accessible via API and dashboard.

**Estimated effort:** 3 weeks.
**Dependencies:** `platform/integrations.md`.

### 5. Multi-country regulatory research

**Description:** Research and document the regulatory requirements for expanding Bono Pay beyond the DRC. Identify common patterns and country-specific adaptations.

**Target countries (research only):**

| Country | Fiscal regime | Priority |
|---------|---------------|----------|
| Republic of Congo (Brazzaville) | SFE-like regime (research needed) | High |
| Rwanda | EBM (Electronic Billing Machine) | Medium |
| Kenya | TIMS (Tax Invoice Management System) | Medium |
| Cameroon | MECeF (Machine Électronique Certifiée de Facturation) | Low |

**Deliverables:**

- Regulatory summary per country (equivalent of `regulatory/` folder).
- Gap analysis: what Bono Pay already supports vs. what needs adaptation.
- Architecture impact assessment: multi-country tax engine, multi-currency, localization.
- Go/no-go recommendation for each country.

**Estimated effort:** 4 weeks of research + 2 weeks for documentation.

## Risks

!!! warning "Phase 4 Risks"
    - ERP connector maintenance burden: each connector requires ongoing updates as ERPs release new versions.
    - Multi-country expansion may require separate legal entities and local partnerships.
    - Analytics on large datasets requires careful data warehouse design to avoid performance issues.
    - Event streaming infrastructure (Kafka/NATS) adds operational complexity.

## Success criteria

- At least 2 ERP connectors certified and deployed with enterprise customers.
- Fleet dashboard supports 3+ enterprise merchants with 50+ outlets each.
- Analytics reports are used by at least 5 merchants for tax planning.
- Multi-country research delivers go/no-go recommendations for at least 2 countries.
