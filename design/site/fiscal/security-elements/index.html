
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../tax-engine/" rel="prev"/>
<link href="../invoice-verification/" rel="next"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.7.1" name="generator"/>
<title>Security Elements - Bono Pay Technical Design</title>
<link href="../../assets/stylesheets/main.484c7ddc.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.ab4e12ef.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../assets/mermaid-zoom.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="#3FFF00" data-md-color-primary="#3FFF00" data-md-color-scheme="slate" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#security-elements-on-invoices">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Bono Pay Technical Design" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Bono Pay Technical Design">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Bono Pay Technical Design
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Security Elements
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Bono Pay Technical Design" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Bono Pay Technical Design">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    Bono Pay Technical Design
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    
  
    Home
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            
  
    Architecture
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../architecture/overview/">
<span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../architecture/trust-boundary/">
<span class="md-ellipsis">
    
  
    Trust Boundary
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../architecture/components/">
<span class="md-ellipsis">
    
  
    Component Map
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../architecture/data-flow/">
<span class="md-ellipsis">
    
  
    Data Flow
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Invoicing Platform
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            
  
    Invoicing Platform
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../platform/overview/">
<span class="md-ellipsis">
    
  
    Product Overview
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../platform/api/">
<span class="md-ellipsis">
    
  
    Invoicing API
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../platform/dashboard/">
<span class="md-ellipsis">
    
  
    Web Dashboard
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../platform/sdk/">
<span class="md-ellipsis">
    
  
    SDK &amp; Libraries
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Fiscal Engine
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            
  
    Fiscal Engine
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../invoice-lifecycle/">
<span class="md-ellipsis">
    
  
    Invoice Lifecycle
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tax-engine/">
<span class="md-ellipsis">
    
  
    Tax Engine (14 Groups)
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    
  
    Security Elements
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    
  
    Security Elements
  

    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#sequential-fiscal-invoice-number">
<span class="md-ellipsis">
      
        Sequential fiscal invoice number
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fiscal-authority-id">
<span class="md-ellipsis">
      
        Fiscal authority ID
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cryptographic-authentication-code-signature">
<span class="md-ellipsis">
      
        Cryptographic authentication code (signature)
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#trusted-timestamp">
<span class="md-ellipsis">
      
        Trusted timestamp
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#qr-code-encoding-verification-data">
<span class="md-ellipsis">
      
        QR code encoding verification data
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#mock-receipt-layout">
<span class="md-ellipsis">
      
        Mock receipt layout
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hash-chain-integrity">
<span class="md-ellipsis">
      
        Hash-chain integrity
      
    </span>
</a>
<nav aria-label="Hash-chain integrity" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#how-it-works">
<span class="md-ellipsis">
      
        How it works
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ledger-entry-structure">
<span class="md-ellipsis">
      
        Ledger entry structure
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chain-verification">
<span class="md-ellipsis">
      
        Chain verification
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#immutability-guarantees">
<span class="md-ellipsis">
      
        Immutability guarantees
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#maintaining-compliance">
<span class="md-ellipsis">
      
        Maintaining compliance
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../invoice-verification/">
<span class="md-ellipsis">
    
  
    Invoice Verification
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../reports/">
<span class="md-ellipsis">
    
  
    Reports (Z/X/A)
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Cloud &amp; Sync
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            
  
    Cloud &amp; Sync
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../cloud/architecture/">
<span class="md-ellipsis">
    
  
    Cloud Architecture
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cloud/offline-sync/">
<span class="md-ellipsis">
    
  
    Offline-First Sync
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cloud/dgi-integration/">
<span class="md-ellipsis">
    
  
    DGI Integration
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Platform &amp; Integrations
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            
  
    Platform &amp; Integrations
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../platform/multi-user/">
<span class="md-ellipsis">
    
  
    Multi-User Access
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../platform/ai-capabilities/">
<span class="md-ellipsis">
    
  
    AI &amp; Natural Language
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../platform/integrations/">
<span class="md-ellipsis">
    
  
    Integrations
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Regulatory
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            
  
    Regulatory
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../regulatory/legal-framework/">
<span class="md-ellipsis">
    
  
    DRC Legal Framework
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../regulatory/arretes/">
<span class="md-ellipsis">
    
  
    Arrêté Summary
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../regulatory/sfe-specs/">
<span class="md-ellipsis">
    
  
    SFE Specifications
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
<span class="md-ellipsis">
    
  
    ADRs
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
            
  
    ADRs
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../adr/">
<span class="md-ellipsis">
    
  
    Index
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../adr/adr-0001/">
<span class="md-ellipsis">
    
  
    0001 - Two-Phase Commit
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../adr/adr-0002/">
<span class="md-ellipsis">
    
  
    0002 - Signature Algorithm
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../adr/adr-0003/">
<span class="md-ellipsis">
    
  
    0003 - Platform Technology Stack
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../adr/adr-0004/">
<span class="md-ellipsis">
    
  
    0004 - Cloud Fiscal Signing
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../adr/adr-0005/">
<span class="md-ellipsis">
    
  
    0005 - Strategic Pivot
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
<span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_9_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_9">
<span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/cloud/">
<span class="md-ellipsis">
    
  
    Cloud API
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/invoicing-sdk/">
<span class="md-ellipsis">
    
  
    Invoicing SDK
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_10" type="checkbox"/>
<label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Implementation
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_10_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_10">
<span class="md-nav__icon md-icon"></span>
            
  
    Implementation
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../implementation/roadmap/">
<span class="md-ellipsis">
    
  
    Roadmap
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../implementation/phase-1/">
<span class="md-ellipsis">
    
  
    Phase 1 - Software Invoicing
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../implementation/phase-2/">
<span class="md-ellipsis">
    
  
    Phase 2 - POS &amp; Retail
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../implementation/phase-3/">
<span class="md-ellipsis">
    
  
    Phase 3 - USB Hardware
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../implementation/phase-4/">
<span class="md-ellipsis">
    
  
    Phase 4 - Enterprise
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#sequential-fiscal-invoice-number">
<span class="md-ellipsis">
      
        Sequential fiscal invoice number
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fiscal-authority-id">
<span class="md-ellipsis">
      
        Fiscal authority ID
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cryptographic-authentication-code-signature">
<span class="md-ellipsis">
      
        Cryptographic authentication code (signature)
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#trusted-timestamp">
<span class="md-ellipsis">
      
        Trusted timestamp
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#qr-code-encoding-verification-data">
<span class="md-ellipsis">
      
        QR code encoding verification data
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#mock-receipt-layout">
<span class="md-ellipsis">
      
        Mock receipt layout
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hash-chain-integrity">
<span class="md-ellipsis">
      
        Hash-chain integrity
      
    </span>
</a>
<nav aria-label="Hash-chain integrity" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#how-it-works">
<span class="md-ellipsis">
      
        How it works
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ledger-entry-structure">
<span class="md-ellipsis">
      
        Ledger entry structure
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chain-verification">
<span class="md-ellipsis">
      
        Chain verification
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#immutability-guarantees">
<span class="md-ellipsis">
      
        Immutability guarantees
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#maintaining-compliance">
<span class="md-ellipsis">
      
        Maintaining compliance
      
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="security-elements-on-invoices">Security Elements on Invoices<a class="headerlink" href="#security-elements-on-invoices" title="Permanent link">¶</a></h1>
<p>The DGI SFE specification and the Bono Pay architecture mandate that every fiscal event carries <strong>five immutable security elements</strong>. In Phase 1 (Software Invoicing), the <strong>Cloud Signing Service (HSM)</strong> owns the counters, identifiers, timestamps, and signatures that prove an invoice was issued by an authorized system. Client applications (web dashboard, API consumers, SDK integrators) must treat these values as sealed outputs — they may display them but never fabricate or modify them.</p>
<div class="admonition warning">
<p class="admonition-title">Cloud-generated security elements</p>
<p>Client applications MAY NOT fabricate any of these values. They are generated inside the Cloud Signing Service (HSM), travel only in sealed responses, and are recorded in the append-only Fiscal Ledger. Missing or modified elements invalidate the invoice.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Phase 3 — USB Hardware</p>
<p>In Phase 3, the USB Fiscal Memory device (DEF) can replace or augment the Cloud Signing Service as the trusted signer for merchants who need full DEF homologation. The five elements remain identical; only the generation source changes. Hardware details are archived in <code>docs-archive/hardware/</code>.</p>
</div>
<h2 id="sequential-fiscal-invoice-number">Sequential fiscal invoice number<a class="headerlink" href="#sequential-fiscal-invoice-number" title="Permanent link">¶</a></h2>
<ul>
<li><strong>What it is:</strong> A monotonic, non-resettable counter that assigns every invoice a unique fiscal number and anchors the hash-chained Fiscal Ledger used for reports.</li>
<li><strong>Generated by:</strong> The Cloud Signing Service via the <strong>Monotonic Counter Manager</strong>, which uses serializable database isolation to guarantee gap-free sequential numbering per outlet.</li>
<li><strong>Receipt placement:</strong> Prominently printed near the merchant header so auditors see the outlet-level fiscal sequence.</li>
<li><strong>Verification:</strong> The dashboard, API consumers, and DGI compare the printed number with the Fiscal Ledger entry, the Z/X reports, and the expected counter for that outlet.</li>
<li><strong>Missing / invalid:</strong> The invoice is immediately rejected by the DGI and cannot be synchronized; the client must re-submit the canonical payload so the Cloud Signing Service can issue a new fiscal number.</li>
</ul>
<h2 id="fiscal-authority-id">Fiscal authority ID<a class="headerlink" href="#fiscal-authority-id" title="Permanent link">¶</a></h2>
<ul>
<li><strong>What it is:</strong> A unique identifier for the Cloud Signing Service instance (or HSM cluster) that produced the fiscal response. In Phase 3, this maps to the DEF NID for USB-signed invoices.</li>
<li><strong>Generated by:</strong> Assigned during HSM provisioning; the Cloud Signing Service includes it in every sealed response alongside the fiscal number and signature.</li>
<li><strong>Receipt placement:</strong> Printed beside the fiscal number in the security block so inspectors can trace the signing authority.</li>
<li><strong>Verification:</strong> Auditors and the DGI cross-check the fiscal authority ID against the registered HSM public key in the Bono Pay Cloud registry.</li>
<li><strong>Missing / invalid:</strong> Without a fiscal authority ID, the invoice cannot be tied to a certified signing service, and the DGI must mark it non-compliant.</li>
</ul>
<h2 id="cryptographic-authentication-code-signature">Cryptographic authentication code (signature)<a class="headerlink" href="#cryptographic-authentication-code-signature" title="Permanent link">¶</a></h2>
<ul>
<li><strong>What it is:</strong> An ECDSA signature over the canonical payload, fiscal number, timestamp, and ledger metadata that proves the Cloud Signing Service approved the invoice.</li>
<li><strong>Generated by:</strong> The HSM inside the Cloud Signing Service using managed private keys that never leave the hardware security boundary.</li>
<li><strong>Receipt placement:</strong> Included in the security block or encoded inside the QR code so scanning software can verify it.</li>
<li><strong>Verification:</strong> The DGI, auditors, and Bono Pay dashboard validate the signature using the HSM's public key from the registry; signatures that fail verification trigger rejection.</li>
<li><strong>Missing / invalid:</strong> If the signature is absent or fails verification, the invoice is treated as unauthenticated and cannot be lodged with the DGI; the client must re-submit the payload for re-signing.</li>
</ul>
<h2 id="trusted-timestamp">Trusted timestamp<a class="headerlink" href="#trusted-timestamp" title="Permanent link">¶</a></h2>
<ul>
<li><strong>What it is:</strong> A UTC timestamp anchored to NTP-synced cloud infrastructure that records when the Cloud Signing Service sealed the invoice.</li>
<li><strong>Generated by:</strong> The Cloud Signing Service at the moment of signing; it cannot be supplied or overridden by client applications.</li>
<li><strong>Receipt placement:</strong> Shown near the fiscal number / authority ID block and embedded in the QR payload to prove when the invoice was sealed.</li>
<li><strong>Verification:</strong> The Fiscal Ledger enforces monotonic ordering per outlet; the DGI and auditors compare timestamps against ledger order to detect drift or replay.</li>
<li><strong>Missing / invalid:</strong> Invoices without a trusted timestamp are non-compliant, cannot be reconciled with Z/X reports, and raise alerts for potential tampering.</li>
</ul>
<h2 id="qr-code-encoding-verification-data">QR code encoding verification data<a class="headerlink" href="#qr-code-encoding-verification-data" title="Permanent link">¶</a></h2>
<ul>
<li><strong>What it is:</strong> A machine-readable encoding of the fiscal number, fiscal authority ID, timestamp, signature, and a verification URL so inspectors and the DGI can validate the invoice.</li>
<li><strong>Generated by:</strong> The Cloud Signing Service after signing; the QR payload contains the sealed data that client applications render on receipts and the Sync Agent uploads to the DGI.</li>
<li><strong>Receipt placement:</strong> Typically printed at the bottom of the receipt, adjacent to the totals and security block.</li>
<li><strong>Verification:</strong> Inspectors and software scan the QR code to replay the data, validate the signature, and confirm the fiscal authority match. The QR encodes a URL to the <strong>public verification portal</strong> at <code>verify.bonopay.cd</code> — see <a href="../invoice-verification/">Invoice Verification</a> for the full verification flow, API, and cryptographic chain checks.</li>
<li><strong>Missing / invalid:</strong> Without the QR code the invoice fails the compliance checklist, and the DGI upload pipeline flags it as incomplete.</li>
</ul>
<h2 id="mock-receipt-layout">Mock receipt layout<a class="headerlink" href="#mock-receipt-layout" title="Permanent link">¶</a></h2>
<pre class="mermaid"><code>flowchart TB
  subgraph receipt["Mock receipt — Bono Pay fiscalized"]
    merchant["Merchant + outlet info"]
    fiscal["Fiscal number\nFiscal authority ID"]
    timestamp["Trusted timestamp"]
    signature["Cryptographic authentication code"]
    qr["QR code — verification payload"]
  end
  merchant --&gt; fiscal --&gt; timestamp --&gt; signature --&gt; qr</code></pre>
<p>The diagram above shows how the five security elements are grouped near the receipt header and security block so every printout carries the data inspectors need. The QR code encapsulates the entire sealed payload, making verification a single scan away.</p>
<h2 id="hash-chain-integrity">Hash-chain integrity<a class="headerlink" href="#hash-chain-integrity" title="Permanent link">¶</a></h2>
<p>Every entry in the Fiscal Ledger is hash-chained to its predecessor, creating a tamper-evident, append-only sequence that auditors and the DGI can verify independently.</p>
<h3 id="how-it-works">How it works<a class="headerlink" href="#how-it-works" title="Permanent link">¶</a></h3>
<ol>
<li><strong>Genesis entry:</strong> The first invoice sealed for an outlet produces a ledger entry whose <code>previous_hash</code> is a well-known zero value (<code>0x00…00</code>). The Cloud Signing Service computes <code>entry_hash = SHA-256(fiscal_number ‖ canonical_payload_hash ‖ signature ‖ timestamp ‖ previous_hash)</code> and stores it alongside the sealed invoice.</li>
<li><strong>Subsequent entries:</strong> Each new ledger entry includes the <code>entry_hash</code> of the immediately preceding entry as its <code>previous_hash</code>. The resulting chain means altering any past entry changes every hash that follows it.</li>
<li><strong>Scope:</strong> Hash chains are maintained <strong>per outlet</strong> so each outlet has an independent, verifiable sequence aligned with its monotonic fiscal number counter.</li>
</ol>
<h3 id="ledger-entry-structure">Ledger entry structure<a class="headerlink" href="#ledger-entry-structure" title="Permanent link">¶</a></h3>
<table>
<thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>fiscal_number</code></td>
<td>Sequential invoice number for the outlet</td>
</tr>
<tr>
<td><code>canonical_payload_hash</code></td>
<td>SHA-256 of the deterministic canonical payload</td>
</tr>
<tr>
<td><code>signature</code></td>
<td>ECDSA signature produced by the Cloud Signing Service (HSM)</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td>Trusted UTC timestamp at the moment of signing</td>
</tr>
<tr>
<td><code>previous_hash</code></td>
<td><code>entry_hash</code> of the preceding ledger entry (<code>0x00…00</code> for the first)</td>
</tr>
<tr>
<td><code>entry_hash</code></td>
<td>SHA-256 of the concatenation of all fields above</td>
</tr>
</tbody>
</table>
<h3 id="chain-verification">Chain verification<a class="headerlink" href="#chain-verification" title="Permanent link">¶</a></h3>
<pre class="mermaid"><code>flowchart LR
  A["Entry N-1\nentry_hash: abc123"] --&gt;|previous_hash| B["Entry N\nentry_hash: def456"]
  B --&gt;|previous_hash| C["Entry N+1\nentry_hash: ghi789"]</code></pre>
<ul>
<li><strong>Online verification:</strong> The <a href="../invoice-verification/">Invoice Verification</a> API checks that the entry's <code>previous_hash</code> matches the preceding entry's <code>entry_hash</code> and recomputes the hash to confirm integrity.</li>
<li><strong>Audit verification:</strong> Z/X/A reports include the opening and closing <code>entry_hash</code> for the period. Auditors walk the chain between those anchors to confirm no entries were inserted, removed, or modified.</li>
<li><strong>Tamper detection:</strong> If any entry is altered, every subsequent <code>entry_hash</code> becomes invalid. The anomaly detection system flags hash-chain breaks as critical alerts.</li>
</ul>
<h3 id="immutability-guarantees">Immutability guarantees<a class="headerlink" href="#immutability-guarantees" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Append-only:</strong> The Fiscal Ledger never updates or deletes entries. Voids, refunds, and credit notes are new fiscal events with their own fiscal numbers and chain links.</li>
<li><strong>Gap detection:</strong> The Monotonic Counter Manager and hash chain together ensure that a missing fiscal number also breaks the chain, making gaps immediately detectable.</li>
<li><strong>Cross-verification:</strong> The DGI receives both the sealed invoice and the <code>entry_hash</code> via the Sync Agent, enabling independent chain reconstruction and verification on the regulatory side.</li>
</ul>
<h2 id="maintaining-compliance">Maintaining compliance<a class="headerlink" href="#maintaining-compliance" title="Permanent link">¶</a></h2>
<p>Client applications always send the canonical payload to the Cloud Signing Service, which returns the five sealed security elements. Even when a client is temporarily offline, it queues the unsigned payload locally (IndexedDB / SQLite) and submits it once connectivity returns — fiscalization only happens when the Cloud Signing Service processes the request. Missing elements, altered values, or attempts to generate them outside the Cloud Signing Service immediately invalidate the invoice and keep it out of the audit trail. If a submission fails (network timeout, validation error), the client retries the request so the Cloud Signing Service can issue all five elements together.</p>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Tax Engine (14 Groups)" class="md-footer__link md-footer__link--prev" href="../tax-engine/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                Tax Engine (14 Groups)
              </div>
</div>
</a>
<a aria-label="Next: Invoice Verification" class="md-footer__link md-footer__link--next" href="../invoice-verification/">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                Invoice Verification
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.footer"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
<script src="../../assets/mermaid-zoom.js"></script>
</body>
</html>